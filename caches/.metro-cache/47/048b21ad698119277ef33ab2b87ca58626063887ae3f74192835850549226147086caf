{"dependencies":[{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"expo/fetch","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":48,"index":98}}],"key":"ug2WTu871fxhwUkT+lg+x8TWZJo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      n[k] = e[k];\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[0], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[1], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _expoVirtualEnv = require(_dependencyMap[2], \"expo/virtual/env\");\n  var _expoSecureStore = require(_dependencyMap[3], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var _expoFetch = require(_dependencyMap[4], \"expo/fetch\");\n  var originalFetch = fetch;\n  var authKey = `${_expoVirtualEnv.env.EXPO_PUBLIC_PROJECT_GROUP_ID}-jwt`;\n  var getURLFromArgs = function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    var urlArg = args[0];\n    var url;\n    if (typeof urlArg === 'string') {\n      url = urlArg;\n    } else if (typeof urlArg === 'object' && urlArg !== null) {\n      url = urlArg.url;\n    } else {\n      url = null;\n    }\n    return url;\n  };\n  var isFirstPartyURL = url => {\n    return url.startsWith('/') || _expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL && url.startsWith(_expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL);\n  };\n  var isSecondPartyURL = url => {\n    return url.startsWith('/_create/');\n  };\n  var fetchToWeb = /*#__PURE__*/function () {\n    var _fetchWithHeaders = (0, _asyncToGenerator.default)(function* () {\n      var firstPartyURL = _expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL;\n      var secondPartyURL = _expoVirtualEnv.env.EXPO_PUBLIC_PROXY_BASE_URL;\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      if (!firstPartyURL || !secondPartyURL) {\n        return (0, _expoFetch.fetch)(...args);\n      }\n      var input = args[0],\n        init = args[1];\n      var url = getURLFromArgs(input, init);\n      if (!url) {\n        return (0, _expoFetch.fetch)(input, init);\n      }\n      var isExternalFetch = !isFirstPartyURL(url);\n      // we should not add headers to requests that don't go to our own server\n      if (isExternalFetch) {\n        return (0, _expoFetch.fetch)(input, init);\n      }\n      var finalInput = input;\n      var baseURL = isSecondPartyURL(url) ? secondPartyURL : firstPartyURL;\n      if (typeof input === 'string') {\n        finalInput = input.startsWith('/') ? `${baseURL}${input}` : input;\n      } else {\n        return originalFetch(input, init);\n      }\n      var initHeaders = init?.headers ?? {};\n      var finalHeaders = new Headers(initHeaders);\n      var headers = {\n        'x-createxyz-project-group-id': _expoVirtualEnv.env.EXPO_PUBLIC_PROJECT_GROUP_ID,\n        host: _expoVirtualEnv.env.EXPO_PUBLIC_HOST,\n        'x-forwarded-host': _expoVirtualEnv.env.EXPO_PUBLIC_HOST,\n        'x-createxyz-host': _expoVirtualEnv.env.EXPO_PUBLIC_HOST\n      };\n      for (var _ref of Object.entries(headers)) {\n        var _ref2 = (0, _slicedToArray.default)(_ref, 2);\n        var key = _ref2[0];\n        var value = _ref2[1];\n        if (value) {\n          finalHeaders.set(key, value);\n        }\n      }\n      var auth = yield SecureStore.getItemAsync(authKey).then(auth => {\n        return auth ? JSON.parse(auth) : null;\n      }).catch(() => {\n        return null;\n      });\n      if (auth) {\n        finalHeaders.set('authorization', `Bearer ${auth.jwt}`);\n      }\n      return (0, _expoFetch.fetch)(finalInput, {\n        ...init,\n        headers: finalHeaders\n      });\n    });\n    function fetchWithHeaders() {\n      return _fetchWithHeaders.apply(this, arguments);\n    }\n    return fetchWithHeaders;\n  }();\n  var _default = fetchToWeb;\n});","lineCount":121,"map":[[21,2,92,0,"Object"],[21,8,92,0],[21,9,92,0,"defineProperty"],[21,23,92,0],[21,24,92,0,"exports"],[21,31,92,0],[22,4,92,0,"enumerable"],[22,14,92,0],[23,4,92,0,"get"],[23,7,92,0],[23,18,92,0,"get"],[23,19,92,0],[24,6,92,0],[24,13,92,0,"_default"],[24,21,92,0],[25,4,92,0],[26,2,92,0],[27,2,92,26],[27,6,92,26,"_babelRuntimeHelpersSlicedToArray"],[27,39,92,26],[27,42,92,26,"require"],[27,49,92,26],[27,50,92,26,"_dependencyMap"],[27,64,92,26],[28,2,92,26],[28,6,92,26,"_slicedToArray"],[28,20,92,26],[28,23,92,26,"_interopDefault"],[28,38,92,26],[28,39,92,26,"_babelRuntimeHelpersSlicedToArray"],[28,72,92,26],[29,2,92,26],[29,6,92,26,"_babelRuntimeHelpersAsyncToGenerator"],[29,42,92,26],[29,45,92,26,"require"],[29,52,92,26],[29,53,92,26,"_dependencyMap"],[29,67,92,26],[30,2,92,26],[30,6,92,26,"_asyncToGenerator"],[30,23,92,26],[30,26,92,26,"_interopDefault"],[30,41,92,26],[30,42,92,26,"_babelRuntimeHelpersAsyncToGenerator"],[30,78,92,26],[31,2,92,26],[31,6,92,26,"_expoVirtualEnv"],[31,21,92,26],[31,24,92,26,"require"],[31,31,92,26],[31,32,92,26,"_dependencyMap"],[31,46,92,26],[32,2,1,0],[32,6,1,0,"_expoSecureStore"],[32,22,1,0],[32,25,1,0,"require"],[32,32,1,0],[32,33,1,0,"_dependencyMap"],[32,47,1,0],[33,2,1,0],[33,6,1,0,"SecureStore"],[33,17,1,0],[33,20,1,0,"_interopNamespace"],[33,37,1,0],[33,38,1,0,"_expoSecureStore"],[33,54,1,0],[34,2,2,0],[34,6,2,0,"_expoFetch"],[34,16,2,0],[34,19,2,0,"require"],[34,26,2,0],[34,27,2,0,"_dependencyMap"],[34,41,2,0],[35,2,4,0],[35,6,4,6,"originalFetch"],[35,19,4,19],[35,22,4,22,"fetch"],[35,27,4,27],[36,2,5,0],[36,6,5,6,"authKey"],[36,13,5,13],[36,16,5,16],[36,19,5,16,"_expoVirtualEnv"],[36,34,5,16],[36,35,5,16,"env"],[36,38,5,16],[36,39,5,16,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[36,67,5,16],[36,73,5,65],[37,2,7,0],[37,6,7,6,"getURLFromArgs"],[37,20,7,20],[37,23,7,23],[37,32,7,23,"getURLFromArgs"],[37,33,7,23],[37,35,7,62],[38,4,7,62],[38,13,7,62,"_len"],[38,17,7,62],[38,20,7,62,"arguments"],[38,29,7,62],[38,30,7,62,"length"],[38,36,7,62],[38,38,7,27,"args"],[38,42,7,31],[38,49,7,31,"Array"],[38,54,7,31],[38,55,7,31,"_len"],[38,59,7,31],[38,62,7,31,"_key"],[38,66,7,31],[38,72,7,31,"_key"],[38,76,7,31],[38,79,7,31,"_len"],[38,83,7,31],[38,85,7,31,"_key"],[38,89,7,31],[39,6,7,27,"args"],[39,10,7,31],[39,11,7,31,"_key"],[39,15,7,31],[39,19,7,31,"arguments"],[39,28,7,31],[39,29,7,31,"_key"],[39,33,7,31],[40,4,7,31],[41,4,8,2],[41,8,8,9,"urlArg"],[41,14,8,15],[41,17,8,19,"args"],[41,21,8,23],[42,4,9,2],[42,8,9,6,"url"],[42,11,9,24],[43,4,10,2],[43,8,10,6],[43,15,10,13,"urlArg"],[43,21,10,19],[43,26,10,24],[43,34,10,32],[43,36,10,34],[44,6,11,4,"url"],[44,9,11,7],[44,12,11,10,"urlArg"],[44,18,11,16],[45,4,12,2],[45,5,12,3],[45,11,12,9],[45,15,12,13],[45,22,12,20,"urlArg"],[45,28,12,26],[45,33,12,31],[45,41,12,39],[45,45,12,43,"urlArg"],[45,51,12,49],[45,56,12,54],[45,60,12,58],[45,62,12,60],[46,6,13,4,"url"],[46,9,13,7],[46,12,13,10,"urlArg"],[46,18,13,16],[46,19,13,17,"url"],[46,22,13,20],[47,4,14,2],[47,5,14,3],[47,11,14,9],[48,6,15,4,"url"],[48,9,15,7],[48,12,15,10],[48,16,15,14],[49,4,16,2],[50,4,17,2],[50,11,17,9,"url"],[50,14,17,12],[51,2,18,0],[51,3,18,1],[52,2,20,0],[52,6,20,6,"isFirstPartyURL"],[52,21,20,21],[52,24,20,25,"url"],[52,27,20,36],[52,31,20,41],[53,4,21,2],[53,11,22,4,"url"],[53,14,22,7],[53,15,22,8,"startsWith"],[53,25,22,18],[53,26,22,19],[53,29,22,22],[53,30,22,23],[53,34,23,5,"_expoVirtualEnv"],[53,49,23,5],[53,50,23,5,"env"],[53,53,23,5],[53,54,23,5,"EXPO_PUBLIC_BASE_URL"],[53,74,23,5],[53,78,23,41,"url"],[53,81,23,44],[53,82,23,45,"startsWith"],[53,92,23,55],[53,93,23,55,"_expoVirtualEnv"],[53,108,23,55],[53,109,23,55,"env"],[53,112,23,55],[53,113,23,55,"EXPO_PUBLIC_BASE_URL"],[53,133,23,88],[53,134,23,90],[54,2,25,0],[54,3,25,1],[55,2,27,0],[55,6,27,6,"isSecondPartyURL"],[55,22,27,22],[55,25,27,26,"url"],[55,28,27,37],[55,32,27,42],[56,4,28,2],[56,11,28,9,"url"],[56,14,28,12],[56,15,28,13,"startsWith"],[56,25,28,23],[56,26,28,24],[56,37,28,35],[56,38,28,36],[57,2,29,0],[57,3,29,1],[58,2,32,0],[58,6,32,6,"fetchToWeb"],[58,16,32,16],[59,4,32,16],[59,8,32,16,"_fetchWithHeaders"],[59,25,32,16],[59,32,32,16,"_asyncToGenerator"],[59,49,32,16],[59,50,32,16,"default"],[59,57,32,16],[59,59,32,19],[59,72,32,68],[60,6,33,2],[60,10,33,8,"firstPartyURL"],[60,23,33,21],[60,26,33,21,"_expoVirtualEnv"],[60,41,33,21],[60,42,33,21,"env"],[60,45,33,21],[60,46,33,21,"EXPO_PUBLIC_BASE_URL"],[60,66,33,56],[61,6,34,2],[61,10,34,8,"secondPartyURL"],[61,24,34,22],[61,27,34,22,"_expoVirtualEnv"],[61,42,34,22],[61,43,34,22,"env"],[61,46,34,22],[61,47,34,22,"EXPO_PUBLIC_PROXY_BASE_URL"],[61,73,34,63],[62,6,34,64],[62,15,34,64,"_len2"],[62,20,34,64],[62,23,34,64,"arguments"],[62,32,34,64],[62,33,34,64,"length"],[62,39,34,64],[62,41,32,54,"args"],[62,45,32,58],[62,52,32,58,"Array"],[62,57,32,58],[62,58,32,58,"_len2"],[62,63,32,58],[62,66,32,58,"_key2"],[62,71,32,58],[62,77,32,58,"_key2"],[62,82,32,58],[62,85,32,58,"_len2"],[62,90,32,58],[62,92,32,58,"_key2"],[62,97,32,58],[63,8,32,54,"args"],[63,12,32,58],[63,13,32,58,"_key2"],[63,18,32,58],[63,22,32,58,"arguments"],[63,31,32,58],[63,32,32,58,"_key2"],[63,37,32,58],[64,6,32,58],[65,6,35,2],[65,10,35,6],[65,11,35,7,"firstPartyURL"],[65,24,35,20],[65,28,35,24],[65,29,35,25,"secondPartyURL"],[65,43,35,39],[65,45,35,41],[66,8,36,4],[66,15,36,11],[66,19,36,11,"expoFetch"],[66,29,36,20],[66,30,36,20,"fetch"],[66,35,36,20],[66,37,36,21],[66,40,36,24,"args"],[66,44,36,28],[66,45,36,29],[67,6,37,2],[68,6,38,2],[68,10,38,9,"input"],[68,15,38,14],[68,18,38,24,"args"],[68,22,38,28],[69,8,38,16,"init"],[69,12,38,20],[69,15,38,24,"args"],[69,19,38,28],[70,6,39,2],[70,10,39,8,"url"],[70,13,39,11],[70,16,39,14,"getURLFromArgs"],[70,30,39,28],[70,31,39,29,"input"],[70,36,39,34],[70,38,39,36,"init"],[70,42,39,40],[70,43,39,41],[71,6,40,2],[71,10,40,6],[71,11,40,7,"url"],[71,14,40,10],[71,16,40,12],[72,8,41,4],[72,15,41,11],[72,19,41,11,"expoFetch"],[72,29,41,20],[72,30,41,20,"fetch"],[72,35,41,20],[72,37,41,21,"input"],[72,42,41,26],[72,44,41,28,"init"],[72,48,41,32],[72,49,41,33],[73,6,42,2],[74,6,44,2],[74,10,44,8,"isExternalFetch"],[74,25,44,23],[74,28,44,26],[74,29,44,27,"isFirstPartyURL"],[74,44,44,42],[74,45,44,43,"url"],[74,48,44,46],[74,49,44,47],[75,6,45,2],[76,6,46,2],[76,10,46,6,"isExternalFetch"],[76,25,46,21],[76,27,46,23],[77,8,47,4],[77,15,47,11],[77,19,47,11,"expoFetch"],[77,29,47,20],[77,30,47,20,"fetch"],[77,35,47,20],[77,37,47,21,"input"],[77,42,47,26],[77,44,47,28,"init"],[77,48,47,32],[77,49,47,33],[78,6,48,2],[79,6,50,2],[79,10,50,6,"finalInput"],[79,20,50,16],[79,23,50,19,"input"],[79,28,50,24],[80,6,51,2],[80,10,51,8,"baseURL"],[80,17,51,15],[80,20,51,18,"isSecondPartyURL"],[80,36,51,34],[80,37,51,35,"url"],[80,40,51,38],[80,41,51,39],[80,44,51,42,"secondPartyURL"],[80,58,51,56],[80,61,51,59,"firstPartyURL"],[80,74,51,72],[81,6,52,2],[81,10,52,6],[81,17,52,13,"input"],[81,22,52,18],[81,27,52,23],[81,35,52,31],[81,37,52,33],[82,8,53,4,"finalInput"],[82,18,53,14],[82,21,53,17,"input"],[82,26,53,22],[82,27,53,23,"startsWith"],[82,37,53,33],[82,38,53,34],[82,41,53,37],[82,42,53,38],[82,45,53,41],[82,48,53,44,"baseURL"],[82,55,53,51],[82,58,53,54,"input"],[82,63,53,59],[82,65,53,61],[82,68,53,64,"input"],[82,73,53,69],[83,6,54,2],[83,7,54,3],[83,13,54,9],[84,8,55,4],[84,15,55,11,"originalFetch"],[84,28,55,24],[84,29,55,25,"input"],[84,34,55,30],[84,36,55,32,"init"],[84,40,55,36],[84,41,55,37],[85,6,56,2],[86,6,58,2],[86,10,58,8,"initHeaders"],[86,21,58,19],[86,24,58,22,"init"],[86,28,58,26],[86,30,58,28,"headers"],[86,37,58,35],[86,41,58,39],[86,42,58,40],[86,43,58,41],[87,6,59,2],[87,10,59,8,"finalHeaders"],[87,22,59,20],[87,25,59,23],[87,29,59,27,"Headers"],[87,36,59,34],[87,37,59,35,"initHeaders"],[87,48,59,46],[87,49,59,47],[88,6,61,2],[88,10,61,8,"headers"],[88,17,61,15],[88,20,61,18],[89,8,62,4],[89,38,62,34],[89,40,62,34,"_expoVirtualEnv"],[89,55,62,34],[89,56,62,34,"env"],[89,59,62,34],[89,60,62,34,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[89,88,62,76],[90,8,63,4,"host"],[90,12,63,8],[90,14,63,8,"_expoVirtualEnv"],[90,29,63,8],[90,30,63,8,"env"],[90,33,63,8],[90,34,63,8,"EXPO_PUBLIC_HOST"],[90,50,63,38],[91,8,64,4],[91,26,64,22],[91,28,64,22,"_expoVirtualEnv"],[91,43,64,22],[91,44,64,22,"env"],[91,47,64,22],[91,48,64,22,"EXPO_PUBLIC_HOST"],[91,64,64,52],[92,8,65,4],[92,26,65,22],[92,28,65,22,"_expoVirtualEnv"],[92,43,65,22],[92,44,65,22,"env"],[92,47,65,22],[92,48,65,22,"EXPO_PUBLIC_HOST"],[93,6,66,2],[93,7,66,3],[94,6,68,2],[94,15,68,2,"_ref"],[94,19,68,2],[94,23,68,29,"Object"],[94,29,68,35],[94,30,68,36,"entries"],[94,37,68,43],[94,38,68,44,"headers"],[94,45,68,51],[94,46,68,52],[94,48,68,54],[95,8,68,54],[95,12,68,54,"_ref2"],[95,17,68,54],[95,24,68,54,"_slicedToArray"],[95,38,68,54],[95,39,68,54,"default"],[95,46,68,54],[95,48,68,54,"_ref"],[95,52,68,54],[96,8,68,54],[96,12,68,14,"key"],[96,15,68,17],[96,18,68,17,"_ref2"],[96,23,68,17],[97,8,68,17],[97,12,68,19,"value"],[97,17,68,24],[97,20,68,24,"_ref2"],[97,25,68,24],[98,8,69,4],[98,12,69,8,"value"],[98,17,69,13],[98,19,69,15],[99,10,70,6,"finalHeaders"],[99,22,70,18],[99,23,70,19,"set"],[99,26,70,22],[99,27,70,23,"key"],[99,30,70,26],[99,32,70,28,"value"],[99,37,70,33],[99,38,70,34],[100,8,71,4],[101,6,72,2],[102,6,74,2],[102,10,74,8,"auth"],[102,14,74,12],[102,23,74,21,"SecureStore"],[102,34,74,32],[102,35,74,33,"getItemAsync"],[102,47,74,45],[102,48,74,46,"authKey"],[102,55,74,53],[102,56,74,54],[102,57,75,5,"then"],[102,61,75,9],[102,62,75,11,"auth"],[102,66,75,15],[102,70,75,20],[103,8,76,6],[103,15,76,13,"auth"],[103,19,76,17],[103,22,76,20,"JSON"],[103,26,76,24],[103,27,76,25,"parse"],[103,32,76,30],[103,33,76,31,"auth"],[103,37,76,35],[103,38,76,36],[103,41,76,39],[103,45,76,43],[104,6,77,4],[104,7,77,5],[104,8,77,6],[104,9,78,5,"catch"],[104,14,78,10],[104,15,78,11],[104,21,78,17],[105,8,79,6],[105,15,79,13],[105,19,79,17],[106,6,80,4],[106,7,80,5],[106,8,80,6],[107,6,82,2],[107,10,82,6,"auth"],[107,14,82,10],[107,16,82,12],[108,8,83,4,"finalHeaders"],[108,20,83,16],[108,21,83,17,"set"],[108,24,83,20],[108,25,83,21],[108,40,83,36],[108,42,83,38],[108,52,83,48,"auth"],[108,56,83,52],[108,57,83,53,"jwt"],[108,60,83,56],[108,62,83,58],[108,63,83,59],[109,6,84,2],[110,6,86,2],[110,13,86,9],[110,17,86,9,"expoFetch"],[110,27,86,18],[110,28,86,18,"fetch"],[110,33,86,18],[110,35,86,19,"finalInput"],[110,45,86,29],[110,47,86,31],[111,8,87,4],[111,11,87,7,"init"],[111,15,87,11],[112,8,88,4,"headers"],[112,15,88,11],[112,17,88,13,"finalHeaders"],[113,6,89,2],[113,7,89,3],[113,8,89,4],[114,4,90,0],[114,5,90,1],[115,4,90,1],[115,13,32,34,"fetchWithHeaders"],[115,29,32,50,"fetchWithHeaders"],[115,30,32,50],[116,6,32,50],[116,13,32,50,"_fetchWithHeaders"],[116,30,32,50],[116,31,32,50,"apply"],[116,36,32,50],[116,43,32,50,"arguments"],[116,52,32,50],[117,4,32,50],[118,4,32,50],[118,11,32,34,"fetchWithHeaders"],[118,27,32,50],[119,2,32,50],[119,5,90,1],[120,2,92,0],[120,6,92,0,"_default"],[120,14,92,0],[120,17,92,15,"fetchToWeb"],[120,27,92,25],[121,0,92,26],[121,3]],"functionMap":{"names":["<global>","getURLFromArgs","isFirstPartyURL","isSecondPartyURL","fetchWithHeaders","SecureStore.getItemAsync.then$argument_0","SecureStore.getItemAsync.then._catch$argument_0"],"mappings":"AAA;uBCM;CDW;wBEE;CFK;yBGE;CHE;mBIG;UC2C;KDE;WEC;KFE;CJU"},"hasCjsExports":false},"type":"js/module"}]}