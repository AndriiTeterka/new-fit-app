{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":31,"index":46}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"./NavigationBuilderContext.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":47},"end":{"line":4,"column":73,"index":120}}],"key":"vvb+tbs8cGp9hlTxgL5PZCjRz5E=","exportNames":["*"],"imports":1}},{"name":"./NavigationRouteContext.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":121},"end":{"line":5,"column":69,"index":190}}],"key":"AWXnpGNA5UkH1qQUM7hLv2L9KzI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      n[k] = e[k];\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"shouldPreventRemove\", {\n    enumerable: true,\n    get: function () {\n      return shouldPreventRemove;\n    }\n  });\n  exports.useOnPreventRemove = useOnPreventRemove;\n  var _react = require(_dependencyMap[0], \"react\");\n  var React = _interopNamespace(_react);\n  var _NavigationBuilderContextJs = require(_dependencyMap[1], \"./NavigationBuilderContext.js\");\n  var _NavigationRouteContextJs = require(_dependencyMap[2], \"./NavigationRouteContext.js\");\n  var VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n  var shouldPreventRemove = (emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) => {\n    var nextRouteKeys = nextRoutes.map(route => route.key);\n\n    // Call these in reverse order so last screens handle the event first\n    var removedRoutes = currentRoutes.filter(route => !nextRouteKeys.includes(route.key)).reverse();\n    var visitedRouteKeys =\n    // @ts-expect-error: add this property to mark that we've already emitted this action\n    action[VISITED_ROUTE_KEYS] ?? new Set();\n    var beforeRemoveAction = {\n      ...action,\n      [VISITED_ROUTE_KEYS]: visitedRouteKeys\n    };\n    for (var route of removedRoutes) {\n      if (visitedRouteKeys.has(route.key)) {\n        // Skip if we've already emitted this action for this screen\n        continue;\n      }\n\n      // First, we need to check if any child screens want to prevent it\n      var isPrevented = beforeRemoveListeners[route.key]?.(beforeRemoveAction);\n      if (isPrevented) {\n        return true;\n      }\n      visitedRouteKeys.add(route.key);\n      var event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n    return false;\n  };\n  function useOnPreventRemove(_ref) {\n    var getState = _ref.getState,\n      emitter = _ref.emitter,\n      beforeRemoveListeners = _ref.beforeRemoveListeners;\n    var _React$useContext = React.useContext(_NavigationBuilderContextJs.NavigationBuilderContext),\n      addKeyedListener = _React$useContext.addKeyedListener;\n    var route = React.useContext(_NavigationRouteContextJs.NavigationRouteContext);\n    var routeKey = route?.key;\n    React.useEffect(() => {\n      if (routeKey) {\n        return addKeyedListener?.('beforeRemove', routeKey, action => {\n          var state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":83,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,1,13],[7,11,1,13,"_interopNamespace"],[7,29,1,13,"e"],[7,30,1,13],[8,4,1,13],[8,8,1,13,"e"],[8,9,1,13],[8,13,1,13,"e"],[8,14,1,13],[8,15,1,13,"__esModule"],[8,25,1,13],[8,34,1,13,"e"],[8,35,1,13],[9,4,1,13],[9,8,1,13,"n"],[9,9,1,13],[10,4,1,13],[10,8,1,13,"e"],[10,9,1,13],[10,11,1,13,"Object"],[10,17,1,13],[10,18,1,13,"keys"],[10,22,1,13],[10,23,1,13,"e"],[10,24,1,13],[10,26,1,13,"forEach"],[10,33,1,13],[10,44,1,13,"k"],[10,45,1,13],[11,6,1,13,"n"],[11,7,1,13],[11,8,1,13,"k"],[11,9,1,13],[11,13,1,13,"e"],[11,14,1,13],[11,15,1,13,"k"],[11,16,1,13],[12,4,1,13],[13,4,1,13,"n"],[13,5,1,13],[13,6,1,13,"default"],[13,13,1,13],[13,16,1,13,"e"],[13,17,1,13],[14,4,1,13],[14,11,1,13,"n"],[14,12,1,13],[15,2,1,13],[16,2,7,0,"Object"],[16,8,7,0],[16,9,7,0,"defineProperty"],[16,23,7,0],[16,24,7,0,"exports"],[16,31,7,0],[17,4,7,0,"enumerable"],[17,14,7,0],[18,4,7,0,"get"],[18,7,7,0],[18,18,7,0,"get"],[18,19,7,0],[19,6,7,0],[19,13,7,0,"shouldPreventRemove"],[19,32,7,0],[20,4,7,0],[21,2,7,0],[22,2,45,0,"exports"],[22,9,45,0],[22,10,45,0,"useOnPreventRemove"],[22,28,45,0],[22,31,45,0,"useOnPreventRemove"],[22,49,45,0],[23,2,3,0],[23,6,3,0,"_react"],[23,12,3,0],[23,15,3,0,"require"],[23,22,3,0],[23,23,3,0,"_dependencyMap"],[23,37,3,0],[24,2,3,0],[24,6,3,0,"React"],[24,11,3,0],[24,14,3,0,"_interopNamespace"],[24,31,3,0],[24,32,3,0,"_react"],[24,38,3,0],[25,2,4,0],[25,6,4,0,"_NavigationBuilderContextJs"],[25,33,4,0],[25,36,4,0,"require"],[25,43,4,0],[25,44,4,0,"_dependencyMap"],[25,58,4,0],[26,2,5,0],[26,6,5,0,"_NavigationRouteContextJs"],[26,31,5,0],[26,34,5,0,"require"],[26,41,5,0],[26,42,5,0,"_dependencyMap"],[26,56,5,0],[27,2,6,0],[27,6,6,6,"VISITED_ROUTE_KEYS"],[27,24,6,24],[27,27,6,27,"Symbol"],[27,33,6,33],[27,34,6,34],[27,54,6,54],[27,55,6,55],[28,2,7,7],[28,6,7,13,"shouldPreventRemove"],[28,25,7,32],[28,28,7,35,"shouldPreventRemove"],[28,29,7,36,"emitter"],[28,36,7,43],[28,38,7,45,"beforeRemoveListeners"],[28,59,7,66],[28,61,7,68,"currentRoutes"],[28,74,7,81],[28,76,7,83,"nextRoutes"],[28,86,7,93],[28,88,7,95,"action"],[28,94,7,101],[28,99,7,106],[29,4,8,2],[29,8,8,8,"nextRouteKeys"],[29,21,8,21],[29,24,8,24,"nextRoutes"],[29,34,8,34],[29,35,8,35,"map"],[29,38,8,38],[29,39,8,39,"route"],[29,44,8,44],[29,48,8,48,"route"],[29,53,8,53],[29,54,8,54,"key"],[29,57,8,57],[29,58,8,58],[31,4,10,2],[32,4,11,2],[32,8,11,8,"removedRoutes"],[32,21,11,21],[32,24,11,24,"currentRoutes"],[32,37,11,37],[32,38,11,38,"filter"],[32,44,11,44],[32,45,11,45,"route"],[32,50,11,50],[32,54,11,54],[32,55,11,55,"nextRouteKeys"],[32,68,11,68],[32,69,11,69,"includes"],[32,77,11,77],[32,78,11,78,"route"],[32,83,11,83],[32,84,11,84,"key"],[32,87,11,87],[32,88,11,88],[32,89,11,89],[32,90,11,90,"reverse"],[32,97,11,97],[32,98,11,98],[32,99,11,99],[33,4,12,2],[33,8,12,8,"visitedRouteKeys"],[33,24,12,24],[34,4,13,2],[35,4,14,2,"action"],[35,10,14,8],[35,11,14,9,"VISITED_ROUTE_KEYS"],[35,29,14,27],[35,30,14,28],[35,34,14,32],[35,38,14,36,"Set"],[35,41,14,39],[35,42,14,40],[35,43,14,41],[36,4,15,2],[36,8,15,8,"beforeRemoveAction"],[36,26,15,26],[36,29,15,29],[37,6,16,4],[37,9,16,7,"action"],[37,15,16,13],[38,6,17,4],[38,7,17,5,"VISITED_ROUTE_KEYS"],[38,25,17,23],[38,28,17,26,"visitedRouteKeys"],[39,4,18,2],[39,5,18,3],[40,4,19,2],[40,9,19,7],[40,13,19,13,"route"],[40,18,19,18],[40,22,19,22,"removedRoutes"],[40,35,19,35],[40,37,19,37],[41,6,20,4],[41,10,20,8,"visitedRouteKeys"],[41,26,20,24],[41,27,20,25,"has"],[41,30,20,28],[41,31,20,29,"route"],[41,36,20,34],[41,37,20,35,"key"],[41,40,20,38],[41,41,20,39],[41,43,20,41],[42,8,21,6],[43,8,22,6],[44,6,23,4],[46,6,25,4],[47,6,26,4],[47,10,26,10,"isPrevented"],[47,21,26,21],[47,24,26,24,"beforeRemoveListeners"],[47,45,26,45],[47,46,26,46,"route"],[47,51,26,51],[47,52,26,52,"key"],[47,55,26,55],[47,56,26,56],[47,59,26,59,"beforeRemoveAction"],[47,77,26,77],[47,78,26,78],[48,6,27,4],[48,10,27,8,"isPrevented"],[48,21,27,19],[48,23,27,21],[49,8,28,6],[49,15,28,13],[49,19,28,17],[50,6,29,4],[51,6,30,4,"visitedRouteKeys"],[51,22,30,20],[51,23,30,21,"add"],[51,26,30,24],[51,27,30,25,"route"],[51,32,30,30],[51,33,30,31,"key"],[51,36,30,34],[51,37,30,35],[52,6,31,4],[52,10,31,10,"event"],[52,15,31,15],[52,18,31,18,"emitter"],[52,25,31,25],[52,26,31,26,"emit"],[52,30,31,30],[52,31,31,31],[53,8,32,6,"type"],[53,12,32,10],[53,14,32,12],[53,28,32,26],[54,8,33,6,"target"],[54,14,33,12],[54,16,33,14,"route"],[54,21,33,19],[54,22,33,20,"key"],[54,25,33,23],[55,8,34,6,"data"],[55,12,34,10],[55,14,34,12],[56,10,35,8,"action"],[56,16,35,14],[56,18,35,16,"beforeRemoveAction"],[57,8,36,6],[57,9,36,7],[58,8,37,6,"canPreventDefault"],[58,25,37,23],[58,27,37,25],[59,6,38,4],[59,7,38,5],[59,8,38,6],[60,6,39,4],[60,10,39,8,"event"],[60,15,39,13],[60,16,39,14,"defaultPrevented"],[60,32,39,30],[60,34,39,32],[61,8,40,6],[61,15,40,13],[61,19,40,17],[62,6,41,4],[63,4,42,2],[64,4,43,2],[64,11,43,9],[64,16,43,14],[65,2,44,0],[65,3,44,1],[66,2,45,7],[66,11,45,16,"useOnPreventRemove"],[66,29,45,34,"useOnPreventRemove"],[66,30,45,34,"_ref"],[66,34,45,34],[66,36,49,3],[67,4,49,3],[67,8,46,2,"getState"],[67,16,46,10],[67,19,46,10,"_ref"],[67,23,46,10],[67,24,46,2,"getState"],[67,32,46,10],[68,6,47,2,"emitter"],[68,13,47,9],[68,16,47,9,"_ref"],[68,20,47,9],[68,21,47,2,"emitter"],[68,28,47,9],[69,6,48,2,"beforeRemoveListeners"],[69,27,48,23],[69,30,48,23,"_ref"],[69,34,48,23],[69,35,48,2,"beforeRemoveListeners"],[69,56,48,23],[70,4,50,2],[70,8,50,2,"_React$useContext"],[70,25,50,2],[70,28,52,6,"React"],[70,33,52,11],[70,34,52,12,"useContext"],[70,44,52,22],[70,45,52,23,"NavigationBuilderContext"],[70,72,52,47],[70,73,52,47,"NavigationBuilderContext"],[70,97,52,47],[70,98,52,48],[71,6,51,4,"addKeyedListener"],[71,22,51,20],[71,25,51,20,"_React$useContext"],[71,42,51,20],[71,43,51,4,"addKeyedListener"],[71,59,51,20],[72,4,53,2],[72,8,53,8,"route"],[72,13,53,13],[72,16,53,16,"React"],[72,21,53,21],[72,22,53,22,"useContext"],[72,32,53,32],[72,33,53,33,"NavigationRouteContext"],[72,58,53,55],[72,59,53,55,"NavigationRouteContext"],[72,81,53,55],[72,82,53,56],[73,4,54,2],[73,8,54,8,"routeKey"],[73,16,54,16],[73,19,54,19,"route"],[73,24,54,24],[73,26,54,26,"key"],[73,29,54,29],[74,4,55,2,"React"],[74,9,55,7],[74,10,55,8,"useEffect"],[74,19,55,17],[74,20,55,18],[74,26,55,24],[75,6,56,4],[75,10,56,8,"routeKey"],[75,18,56,16],[75,20,56,18],[76,8,57,6],[76,15,57,13,"addKeyedListener"],[76,31,57,29],[76,34,57,32],[76,48,57,46],[76,50,57,48,"routeKey"],[76,58,57,56],[76,60,57,58,"action"],[76,66,57,64],[76,70,57,68],[77,10,58,8],[77,14,58,14,"state"],[77,19,58,19],[77,22,58,22,"getState"],[77,30,58,30],[77,31,58,31],[77,32,58,32],[78,10,59,8],[78,17,59,15,"shouldPreventRemove"],[78,36,59,34],[78,37,59,35,"emitter"],[78,44,59,42],[78,46,59,44,"beforeRemoveListeners"],[78,67,59,65],[78,69,59,67,"state"],[78,74,59,72],[78,75,59,73,"routes"],[78,81,59,79],[78,83,59,81],[78,85,59,83],[78,87,59,85,"action"],[78,93,59,91],[78,94,59,92],[79,8,60,6],[79,9,60,7],[79,10,60,8],[80,6,61,4],[81,4,62,2],[81,5,62,3],[81,7,62,5],[81,8,62,6,"addKeyedListener"],[81,24,62,22],[81,26,62,24,"beforeRemoveListeners"],[81,47,62,45],[81,49,62,47,"emitter"],[81,56,62,54],[81,58,62,56,"getState"],[81,66,62,64],[81,68,62,66,"routeKey"],[81,76,62,74],[81,77,62,75],[81,78,62,76],[82,2,63,0],[83,0,63,1],[83,3]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","addKeyedListener$argument_2"],"mappings":"AAA;mCCM;uCCC,kBD;6CEG,2CF;CDiC;OIC;kBCU;0DCE;ODG;GDE;CJC"},"hasCjsExports":false},"type":"js/module"}]}